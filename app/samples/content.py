DEMO_QUESTIONS = {
    "340b_manual": [
        "Who qualifies as a low-income individual under this 340B policy?",
        "What is the process for determining if a patient has a high cost-sharing requirement for insulin?",
        "How often is the 340B EIP formulary reviewed and updated?",
        "Is the health center required to offer 340B insulin pricing at every pharmacy location?",
        "What database is used as the official reference for 340B ceiling prices?",
        "Can the health center charge third-party payors the full price while giving the patient the 340B discount?",
        "What documentation must health centers provide to HRSA to demonstrate compliance with NOA Term 5?",
        "What does the administration fee for 340B EIP cover, and how should it be determined?",
        "Which Executive Order established the requirement for affordable 340B insulin and epinephrine access?",
        "What are the three qualifying conditions for a patient to receive 340B EIP pricing?",
    ],
    "photosynthesis": [
        "What is the Calvin cycle?",
        "How do C4 plants differ from C3 plants?",
        "What role does chlorophyll play in photosynthesis?",
    ],
    "coffee": [
        "How does caffeine work in the brain?",
        "What is the difference between arabica and robusta coffee?",
        "How did coffee first arrive in Europe?",
    ],
    "async_python": [
        "What is the difference between concurrency and parallelism in Python?",
        "How do Task Groups improve on asyncio.gather?",
        "Why is mixing blocking code with async code problematic?",
    ],
}

SAMPLES = {
    "340b_manual": {
        "id": "340b_manual",
        "title": "340B Policy & Procedure Manual — Affordable Insulin & Epinephrine Access (EO 14273)",
        "text": """340B Policy & Procedure Manual

340B.15 – Affordable 340B Insulin & Injectable Epinephrine Access for Low-Income Individuals (EO 14273)

SCOPE: FQHC NAME (hereafter, the health center) adopts this policy for all personnel, including contracted employees.

POLICY: As a Section 330(e) HRSA grant recipient, the health center must comply with the terms and conditions of their award to maintain participation in the HRSA-Funded Health Center Program. The health center has processes in place to ensure compliance with the Notice of Award (NOA) Term 5.

NOA Term 5: "Consistent with Executive Order 14273, the recipient of a grant under section 330(e) of the Public Health Service Act (42 U.S.C. 254b(e)) must have established practices to make insulin and injectable epinephrine available at or below the discounted price paid by the health center grantee (award recipient) or sub-grantee (subrecipient) under the 340B Drug Pricing Program (plus a minimal administration fee) to individuals with low incomes, as determined by the Secretary, who: (a) have a high cost-sharing requirement for either insulin or injectable epinephrine; (b) have a high unmet deductible; or (c) have no health care insurance. For this purpose, a 'low-income individual' is an individual living in a household with an income level at or below 200 percent of the Federal Poverty Guidelines."

PURPOSE: To ensure the health center's compliance with Section 330(e) NOA Term 5 requirement to provide affordable access to insulin and injectable epinephrine, to low-income individuals with high-cost sharing requirements, high unmet deductibles, or no health insurance by extending 340B pricing plus a minimal administration fee, so long as in compliance with state and federal law and not precluded or prohibited by applicable insurance contracts.

DEFINITIONS:

High cost-sharing requirement: Total out-of-pocket cost (including copay, coinsurance, or other non-deductible cost-sharing) for a specific prescription of insulin or injectable epinephrine that exceeds the sum of the discounted price of the designated medication plus the administration fee associated with the 340B EIP.

High unmet deductible: Total out-of-pocket cost due to unmet deductible for a specific prescription of insulin or injectable epinephrine that exceeds the sum of the discounted price of the designated medication plus the administration fee associated with the 340B EIP.

Low-income individual: An individual living in a household with an income level at or below 200 percent of the Federal Poverty Guidelines.

Minimal administration fee: Minimal administration fee may include any dispensing costs, counseling costs, and any other charges associated with the patient receiving the medication.

No health care insurance: An individual who, for a given period, does not have any form of prescription coverage through employer-based insurance, direct purchase, Medicaid, Medicare, military or VA coverage, or other government programs.

PROCEDURE:

The Health Center provides access to insulin and injectable epinephrine at or below the 340B ceiling price, plus a minimal administration fee, to patients with incomes below 200% of the Federal Poverty Guidelines who: have a high cost-sharing requirement for either insulin or injectable epinephrine; have a high unmet deductible; or have no health care insurance.

Eligible Patients: All Health Center patients with incomes below 200% of the Federal Poverty Guidelines who have a high cost-sharing requirement for either insulin or injectable epinephrine, have a high unmet deductible, or have no health care insurance, are eligible for 340B injectable epinephrine and insulin pricing (340B EIP). To ensure compliance with Federal requirements of the 340B program, to be eligible to receive 340B medications, an individual must be a patient of the health center and meet patient eligibility criteria described in HRSA 1996 Patient Definition (See Section 340B.03 – 340B Eligibility).

Eligible Drugs: The health center maintains a formulary of affordable insulin and injectable epinephrine products for access at 340B EIP. This formulary is reviewed and updated quarterly, in line with 340B pricing updates.

340B EIP Access Locations: Patient access to 340B EIP is available at designated locations. While health centers are required to provide access to insulin and injectable epinephrine to low-income patients at affordable prices, NOA Term 5 does not mandate that this occurs at all locations providing pharmaceutical services. BPHC has left this decision to the discretion of each health center to determine what is the appropriate method to employ when creating patient access to these life-saving medications.

"High cost-sharing requirement" and "high unmet deductible": A patient shall be considered to have a "high cost-sharing requirement" and "high unmet deductible" if their total out-of-pocket cost (including any deductible, copay, coinsurance, or other cost-sharing) for a specific prescription of insulin or injectable epinephrine exceeds the sum of the discounted price of the designated medication plus the administration fee associated with the 340B EIP.

Adjudication of 340B Injectable Epinephrine and Insulin Pricing (340B EIP): NOA Term 5 requires eligible low-income individuals can access these medications at or below the discounted price paid by the health center under the 340B Drug Pricing Program plus a minimal administration fee.

340B Price: The OPAIS 340B Pricing Database will serve as the official reference for determining 340B ceiling prices.

Administration Fee: The minimal administration fee may include any dispensing fee, counseling costs, and any other charges associated with the patient receiving the medication. The administration fee should not create a barrier to low-income health center patients accessing these drugs, and health centers should make every reasonable effort to keep the fee as low as possible. State Medicaid professional dispensing fees may be considered as a reference when determining minimal administration fees.

Prescription Adjudication: When available, the health center will adjudicate any insurance as part of this process, to determine if the low-income individual meets the "high cost-sharing" or "high unmet deductible" requirements and is eligible to receive discounts under 340B EIP.

340B EIP Pricing Limitation: NOA Term 5 states the recipient must have established practices to make insulin and injectable epinephrine available at or below the discounted price paid by the health center under the 340B Drug Pricing Program plus a minimal administration fee to individuals with low incomes who: (a) have a high cost-sharing requirement for either insulin or injectable epinephrine; (b) have a high unmet deductible; or (c) have no health care insurance. Because the requirement is to make discounted pricing available to the individual, the health center is not required to charge third-party payors the discounted price. The health center must make and continue to make every reasonable effort to secure payment for services from patients, in accordance with health center fee schedules and the corresponding schedule of discounts.

POLICY RATIONALE: Your practices should be incorporated in written policies and supporting procedures that reflect this determination and that define a "high-cost sharing requirement," a "high unmet deductible," and "no health care insurance" for this purpose. You will document on Form 1C: Documents on File in your future Service Area Competition (SAC) applications or Budget Period Progress Reports (BPRs) that you have current practices, supported by written policies/procedures, that demonstrate your compliance with this term of your award, and you will make those documents available for review upon HRSA's request.""",
    },
    "photosynthesis": {
        "id": "photosynthesis",
        "title": "Photosynthesis: How Plants Convert Light to Energy",
        "text": """Photosynthesis is the biological process by which plants, algae, and certain bacteria convert light energy into chemical energy stored in glucose. This process is fundamental to life on Earth, as it produces the oxygen we breathe and forms the base of nearly all food chains.

The word photosynthesis comes from the Greek words "photo," meaning light, and "synthesis," meaning putting together. The overall equation for photosynthesis can be written as: 6CO2 + 6H2O + light energy → C6H12O6 + 6O2. In other words, carbon dioxide and water are converted into glucose and oxygen using light energy.

Photosynthesis occurs primarily in the leaves of plants, within specialized organelles called chloroplasts. Each chloroplast contains stacks of membrane-bound structures called thylakoids, which are arranged in stacks known as grana. The thylakoid membranes contain chlorophyll, the green pigment that captures light energy. The space surrounding the thylakoids inside the chloroplast is called the stroma, where the second stage of photosynthesis takes place.

The process of photosynthesis consists of two main stages: the light-dependent reactions and the light-independent reactions, also known as the Calvin cycle.

The light-dependent reactions occur in the thylakoid membranes. When chlorophyll absorbs light energy, it excites electrons to a higher energy state. These energized electrons pass through a series of proteins embedded in the thylakoid membrane, collectively known as the electron transport chain. As the electrons move through this chain, their energy is used to pump hydrogen ions across the thylakoid membrane, creating a concentration gradient. This gradient drives ATP synthase, an enzyme that produces ATP (adenosine triphosphate) from ADP and inorganic phosphate. Simultaneously, the enzyme NADP+ reductase uses the electrons to reduce NADP+ to NADPH. Water molecules are split in a process called photolysis to replace the electrons lost by chlorophyll, releasing oxygen as a byproduct.

The Calvin cycle, named after Melvin Calvin who discovered it in the 1950s, takes place in the stroma of the chloroplast. This cycle uses the ATP and NADPH produced during the light-dependent reactions to fix carbon dioxide into organic molecules. The cycle begins when the enzyme RuBisCO (ribulose-1,5-bisphosphate carboxylase/oxygenase) catalyzes the attachment of CO2 to a five-carbon sugar called RuBP (ribulose bisphosphate). This produces an unstable six-carbon compound that immediately splits into two three-carbon molecules called 3-PGA (3-phosphoglyceric acid).

Through a series of reduction reactions powered by ATP and NADPH, the 3-PGA molecules are converted into G3P (glyceraldehyde-3-phosphate). For every three molecules of CO2 that enter the cycle, six molecules of G3P are produced, but only one represents a net gain. The remaining five G3P molecules are used to regenerate RuBP, allowing the cycle to continue. The net G3P molecules can be used to synthesize glucose and other organic compounds needed by the plant.

Several factors affect the rate of photosynthesis. Light intensity is one of the most important — as light increases, the rate of photosynthesis increases up to a point, beyond which additional light provides no benefit because the enzymes become saturated. Temperature also plays a role; photosynthesis rates increase with temperature up to an optimal point (usually around 25-30°C for most plants), after which the enzymes begin to denature and rates decline. Carbon dioxide concentration is another limiting factor — higher CO2 levels generally increase photosynthesis rates until other factors become limiting.

Plants have evolved different strategies for photosynthesis to adapt to various environmental conditions. C3 plants, which include most trees and crops like wheat and rice, use the standard Calvin cycle. C4 plants, such as corn and sugarcane, have evolved an additional carbon fixation step that concentrates CO2 around RuBisCO, reducing a wasteful process called photorespiration. CAM plants, like cacti and succulents, open their stomata at night to collect CO2 and store it as organic acids, then use it for photosynthesis during the day while keeping stomata closed to conserve water.

The importance of photosynthesis extends far beyond individual plants. It is responsible for producing approximately 110 billion tons of dry biomass annually. The oxygen released by photosynthesis maintains the atmospheric oxygen levels at about 21 percent, which is essential for aerobic organisms. Furthermore, photosynthesis drives the global carbon cycle by removing CO2 from the atmosphere and incorporating it into organic matter. Ancient photosynthetic organisms were responsible for the Great Oxidation Event approximately 2.4 billion years ago, which transformed Earth's atmosphere from one with virtually no free oxygen to one capable of supporting complex aerobic life.

Understanding photosynthesis has practical applications in agriculture, where scientists work to improve crop yields by enhancing photosynthetic efficiency. Research into artificial photosynthesis aims to develop technologies that can capture solar energy and convert it into chemical fuels, potentially providing a sustainable energy source for the future. Recent advances in genetic engineering have explored modifying RuBisCO and other photosynthetic enzymes to increase their efficiency, which could significantly boost food production to meet the needs of a growing global population.""",
    },
    "coffee": {
        "id": "coffee",
        "title": "The History and Science of Coffee",
        "text": """Coffee is one of the most widely consumed beverages in the world, with over 2.25 billion cups consumed every day. Its history spans centuries and continents, intertwining with trade, colonialism, culture, and science.

The origin of coffee is steeped in legend. The most popular story attributes its discovery to an Ethiopian goat herder named Kaldi around 850 AD. According to the tale, Kaldi noticed his goats became unusually energetic after eating the bright red berries from a certain tree. Curious, he tried the berries himself and experienced a similar boost of energy. He brought the berries to a local monastery, where the monks found that a drink made from the berries helped them stay alert during long hours of evening prayer.

From Ethiopia, coffee spread to the Arabian Peninsula, where it was first cultivated and traded. By the 15th century, coffee was being grown in the Yemeni district of Arabia, and by the 16th century, it was known in Persia, Egypt, Syria, and Turkey. Coffee houses, known as qahveh khaneh, began appearing in cities across the Near East. These establishments quickly became important centers for social activity and communication — they were called "Schools of the Wise" because of the rich conversations that took place there.

Coffee arrived in Europe in the 17th century and initially met with suspicion. Some people called it the "bitter invention of Satan." When coffee came to Venice in 1615, the local clergy condemned it. Pope Clement VIII was asked to intervene, but after tasting the beverage, he found it so satisfying that he gave it papal approval. Coffee houses rapidly proliferated across Europe, becoming centers of social activity and intellectual exchange in England, Austria, France, Germany, and Holland. In England, coffee houses were called "penny universities" because for the price of a penny, one could purchase a cup of coffee and engage in stimulating conversation.

The Dutch were the first to obtain coffee seedlings for cultivation outside Arabia. After several failed attempts, they succeeded in growing coffee plants in their colonies in Java and Sumatra (modern-day Indonesia) in the late 17th century. This began the era of coffee as a colonial commodity. The French brought coffee to the Caribbean island of Martinique in 1723, and from there it spread throughout Central and South America. Brazil, which received coffee seedlings in 1727, eventually became the world's largest coffee producer, a position it still holds today, producing roughly one-third of the world's coffee supply.

The science behind coffee's stimulating effects centers on caffeine, a natural alkaloid compound with the chemical formula C8H10N4O2. Caffeine works by blocking adenosine receptors in the brain. Adenosine is a neurotransmitter that promotes sleep and suppresses arousal — as it accumulates throughout the day, it makes us feel increasingly tired. Caffeine molecules are similar enough in structure to adenosine that they can bind to the same receptors without activating them, effectively blocking the sleepiness signal. This is why coffee makes us feel more alert and focused.

A typical 8-ounce cup of brewed coffee contains between 80 and 100 milligrams of caffeine, though this varies depending on the type of coffee bean, the roast level, and the brewing method. Espresso, despite its reputation, actually contains less caffeine per serving (about 63 mg per shot) because the serving size is much smaller. However, ounce for ounce, espresso has a higher caffeine concentration.

Coffee contains over 1,000 bioactive compounds beyond caffeine. These include chlorogenic acids, which are powerful antioxidants that may reduce inflammation and lower the risk of certain chronic diseases. Diterpenes like cafestol and kahweol, found in unfiltered coffee, have been shown to raise cholesterol levels but also possess anti-cancer properties. The roasting process creates melanoidins through the Maillard reaction, which contribute to coffee's characteristic brown color and complex flavor and also exhibit antioxidant and antimicrobial properties.

The two primary species of coffee grown commercially are Coffea arabica and Coffea canephora (commonly known as robusta). Arabica accounts for about 60-70 percent of world production and is generally considered to produce a more nuanced, flavorful cup with higher acidity and more complex aroma profiles. It grows best at higher elevations (600-2000 meters) in tropical regions with temperatures between 15-24°C. Robusta, as its name suggests, is a hardier plant that can tolerate higher temperatures and lower elevations. It has roughly twice the caffeine content of arabica and produces a stronger, more bitter cup, making it popular for espresso blends and instant coffee.

The modern specialty coffee movement, sometimes called the "third wave" of coffee, treats coffee much like wine — emphasizing origin, terroir, processing methods, and brewing precision. Single-origin coffees from specific farms or regions are prized for their unique flavor profiles. The Specialty Coffee Association uses a 100-point scale to grade coffee quality, with beans scoring 80 or above designated as "specialty grade."

Coffee processing — the method used to remove the fruit from the bean after harvesting — significantly affects flavor. The washed (wet) process, where the fruit is removed before drying, tends to produce cleaner, brighter flavors. The natural (dry) process, where the fruit dries on the bean, often results in fruitier, more full-bodied cups. The honey process, a hybrid method popular in Costa Rica, removes the skin but leaves some or all of the mucilage on the bean during drying, creating a balanced cup with sweetness and body.

Today, the global coffee industry employs an estimated 125 million people and generates over $200 billion in annual revenue. However, it faces significant challenges including climate change, which threatens to reduce the area suitable for growing arabica coffee by up to 50 percent by 2050. Efforts in sustainable farming practices, fair trade initiatives, and research into climate-resistant coffee varieties are ongoing to ensure the future of this beloved beverage.""",
    },
    "async_python": {
        "id": "async_python",
        "title": "Understanding Python Async Programming",
        "text": """Asynchronous programming in Python allows you to write concurrent code that can handle many tasks simultaneously without using multiple threads or processes. At its core, async programming is about efficiently managing I/O-bound operations — tasks where the program spends most of its time waiting for external resources like network responses, file reads, or database queries.

The foundation of Python's async ecosystem is the asyncio module, which was introduced in Python 3.4 and significantly improved in subsequent releases. The module provides an event loop, which is the central execution mechanism for async code. The event loop runs in a single thread and manages the execution of coroutines, scheduling them and switching between them when one needs to wait for an I/O operation.

A coroutine is a special kind of function defined with the async def syntax. Unlike regular functions that run from start to finish when called, coroutines can be paused and resumed. When a coroutine encounters an await expression, it suspends its execution and yields control back to the event loop, which can then run other coroutines. When the awaited operation completes, the event loop resumes the coroutine from where it left off.

Here is a simple example of async code:

    import asyncio

    async def fetch_data(url):
        print(f"Starting to fetch {url}")
        await asyncio.sleep(2)  # Simulates a network request
        print(f"Finished fetching {url}")
        return f"Data from {url}"

    async def main():
        results = await asyncio.gather(
            fetch_data("https://api.example.com/users"),
            fetch_data("https://api.example.com/posts"),
            fetch_data("https://api.example.com/comments"),
        )
        print(results)

    asyncio.run(main())

In this example, asyncio.gather runs three fetch_data coroutines concurrently. Even though each simulated request takes 2 seconds, all three complete in about 2 seconds total rather than 6, because they run concurrently during the await.

The await keyword can only be used inside an async function, and it can be applied to any awaitable object — coroutines, Tasks, and Futures. A Task is a wrapper around a coroutine that schedules it to run on the event loop. You create tasks with asyncio.create_task(), which allows the coroutine to start running in the background immediately rather than waiting for it to be awaited.

Understanding the difference between concurrency and parallelism is crucial when working with async Python. Concurrency means multiple tasks can make progress over the same period, even if only one is actually executing at any given moment. Parallelism means multiple tasks are literally executing simultaneously on different CPU cores. Python's asyncio provides concurrency, not parallelism — everything runs in a single thread. This is perfectly fine for I/O-bound work, where the bottleneck is waiting for external resources, but it provides no benefit for CPU-bound tasks like number crunching or image processing.

Error handling in async code uses the same try/except syntax as synchronous Python, but with some nuances. When using asyncio.gather(), if one of the coroutines raises an exception, by default it will be raised when the gather result is awaited. You can pass return_exceptions=True to gather() to instead receive exceptions as return values, allowing the other coroutines to complete.

    async def risky_operation():
        raise ValueError("Something went wrong")

    async def main():
        results = await asyncio.gather(
            risky_operation(),
            fetch_data("https://api.example.com/safe"),
            return_exceptions=True,
        )
        for result in results:
            if isinstance(result, Exception):
                print(f"Error: {result}")
            else:
                print(f"Success: {result}")

Async context managers and async iterators extend the async pattern to resource management and iteration. An async context manager uses async with and implements __aenter__ and __aexit__ methods. This is commonly used for managing database connections, HTTP sessions, and file handles in async code.

    async with aiohttp.ClientSession() as session:
        async with session.get("https://api.example.com") as response:
            data = await response.json()

Async iterators use async for and implement __aiter__ and __anext__ methods. They are useful for streaming data from databases, message queues, or web sockets.

    async for message in websocket:
        await process_message(message)

The asyncio module provides several synchronization primitives similar to those in the threading module: Lock, Event, Semaphore, and Condition. Even though async code runs in a single thread and doesn't face race conditions from parallel execution, these primitives are still needed to coordinate access to shared resources. For example, an asyncio.Semaphore can limit the number of concurrent HTTP requests to avoid overwhelming a server.

    semaphore = asyncio.Semaphore(10)  # Max 10 concurrent requests

    async def limited_fetch(url):
        async with semaphore:
            return await fetch_data(url)

Common async libraries in the Python ecosystem include aiohttp for HTTP client and server functionality, asyncpg for PostgreSQL database access, aiofiles for file I/O, and aiocache for caching. The popular web frameworks FastAPI and Starlette are built on top of asyncio, making them naturally async-first.

One important pitfall to avoid is mixing blocking (synchronous) code with async code. If you call a blocking function inside a coroutine without proper handling, it will block the entire event loop and prevent other coroutines from running. For example, using the synchronous requests library instead of aiohttp inside a coroutine will defeat the purpose of using async. If you must use blocking code, you can run it in a thread pool executor using asyncio.to_thread() (Python 3.9+) or loop.run_in_executor().

    # Bad - blocks the event loop
    async def bad_fetch():
        response = requests.get("https://api.example.com")  # Blocks!
        return response.json()

    # Good - runs blocking code in a thread
    async def good_fetch():
        response = await asyncio.to_thread(
            requests.get, "https://api.example.com"
        )
        return response.json()

Python 3.11 introduced Task Groups via asyncio.TaskGroup, which provide a more structured alternative to asyncio.gather(). Task Groups ensure that if one task fails, all other tasks in the group are cancelled, preventing resource leaks and providing cleaner error handling.

    async def main():
        async with asyncio.TaskGroup() as tg:
            task1 = tg.create_task(fetch_data("https://api.example.com/users"))
            task2 = tg.create_task(fetch_data("https://api.example.com/posts"))
        # Both tasks are guaranteed to be done here
        print(task1.result(), task2.result())

Async programming in Python continues to evolve. Python 3.12 and later versions have brought performance improvements to the event loop, better error messages for common async mistakes, and improved typing support for async code. The ecosystem is mature enough that for any new I/O-bound Python project, async should be the default choice for handling concurrent operations.""",
    },
}
